import tile_generator
from PIL import Image
import numpy as np

##### Mario sprites

mario_idle= [
    "0011111000000000",
	"0111111111000000",    
	"0111001100000000",    
	"1010001011000000",    
	"1011000100010000",    
	"1100001111100000",    
	"0010000001000000",    
	"0011111110000000",    
	"0111111111100000",    
	"1111011011110000",    
	"1011111111010000",    
	"1101111110110000",    
	"1111111111110000",    
	"0011100111000000",    
	"0101000010100000",    
	"1111000011110000",    
]

mario_walk_1=[
    "0000011111000000",
    "0000111111111000",
    "0000111001100000",
    "0001010001011000",
    "0001011000100100",
    "0001100001111000",
    "0000010000010000",
    "0011111111100110",
    "0111111111111101",
    "1010111010111110",
    "1100111111100100",
    "0001111111111100",
    "0011111111101100",
    "0101110001111100",
    "0111000000000000",
    "0011100000000000",
]

mario_walk_2=[
    "0000000000000000",
    "0000011111000000",
    "0000111111111000",
    "0000111001100000",
    "0001010001011000",
    "0001011000100100",
    "0001100001111000",
    "0000010000010000",
    "0001111111100000",
    "0010111111011000",
    "0011110111001000",
    "0001111010110000",
    "0010111111100000",
    "1111110111000000",
    "1100001010000000",
    "0000001111000000",
]

mario_walk_3=[
    "0000011111000000",
    "0000111111111000",
    "0000111001100000",
    "0001010001011000",
    "0001011000100100",
    "0001100001111000",
    "0000010000010000",
    "0001111111100000",
    "0011111111100000",
    "0011110110111000",
    "0011111011111100",
    "0001100001110100",
    "0000100011011000",
    "0000111111110000",
    "0000111101111000",
    "0000111110000000",
]

mario_jump=[
    "0000000000000110",
    "0000001111100101",
    "0000011111111111",
    "0000011100110011",
    "0000101000101111",
    "0000101100010011",
    "0000110000111110",
    "0000001000001000",
    "0011111111111000",
    "0111011111101001",
    "1011101111111001",
    "1110111101110111",
    "0001011111111011",
    "0011111111111111",
    "0111000111000000",
    "0100111000000000",
]

#### Level tiles

space = [    
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
]    

mountain_left = [    
	"0000000000000001",
	"0000000000000010",
	"0000000000000100",
	"0000000000001000",
	"0000000000010000",
	"0000000000100000",
	"0000000001000000",
	"0000000010000000",
	"0000000100000000",
	"0000001000000000",
	"0000010000000000",
	"0000100000000000",
	"0001000000000000",
	"0010000000000000",
	"0100000000000000",
	"1000000000000000",
]    

mountain_right = [    
	"1000000000000000",
	"0100000000000000",
	"0010000000000000",
	"0001000000000000",
	"0000100000000000",
	"0000010000000000",
	"0000001000000000",
	"0000000100000000",
	"0000000010000000",
	"0000000001000000",
	"0000000000100000",
	"0000000000010000",
	"0000000000001000",
	"0000000000000100",
	"0000000000000010",
	"0000000000000001",
]    

mountain_top = [    
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000011111100000",
	"0011100000011100",
	"1100000000000011",
]    

mountain_dots = [    
	"0000000000000110",
	"0000000000001111",
	"0000000000001111",
	"0000000000001111",
	"0000000001001111",
	"0000000011100110",
	"0000000011100000",
	"0000000001000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
	"0000000000000000",
]  
pole = [    
	"0000000110000000", 
	"0000000110000000",  
	"0000000110000000", 
	"0000000110000000",  
	"0000000110000000", 
	"0000000110000000",  
	"0000000110000000", 
	"0000000110000000",  
	"0000000110000000", 
	"0000000110000000",  
	"0000000110000000", 
	"0000000110000000",  
	"0000000110000000", 
	"0000000110000000",  
	"0000000110000000", 
	"0000000110000000",  
]    

brick = [    
	"1111111111111111",
	"0001000000010000",
	"0001000000010000",
	"0001000000010000",
	"1111111111111111",
	"0000000100000001",
	"0000000100000001",
	"0000000100000001",
	"1111111111111111",
	"0001000000010000",
	"0001000000010000",
	"0001000000010000",
	"1111111111111111",
	"0000000100000001",
	"0000000100000001",
	"0000000100000001",    
]
im_frame = Image.open('smb.png')
np_frame_org = np.array(im_frame)

np_frame = np_frame_org[3*16:7*16, 0*16:6*16,1]

def get_block(np_frame, x,y):
    b = np_frame[y*16:(y+1)*16, x*16:(x+1)*16]
    o=[]
    for y in range(16):
        s = ""
        for x in range(16):
            if b[y,x]>0:
                s+="0"
            else:
                s+="1"
        o.append(s)
    return o

pipe1 = get_block(np_frame, 4, 0)     
pipe2 = get_block(np_frame, 5, 0)     
pipe3 = get_block(np_frame, 4, 1)     
pipe4 = get_block(np_frame, 5, 1)     

nube1 = get_block(np_frame, 0, 2) 
nube2 = get_block(np_frame, 1, 2) 
nube3 = get_block(np_frame, 2, 2) 

block = get_block(np_frame, 0, 1) 
#brick = get_block(np_frame, 1, 0) 
stones = get_block(np_frame, 0, 0)
q_mark = get_block(np_frame, 2,0)
coin = get_block(np_frame, 3,1)  

##### Level 

solids = {
    "X": block,
    "#": stones,
    "=": brick,
    "?": q_mark,
    "q": pipe1,
    "w": pipe2,
    "a": pipe3,
    "s": pipe4,
}

transparents = {
    " ": space,
    "e": nube1,
    "r": nube2,
    "t": nube3,
    "|": pole,
    "C": coin,
    "[": mountain_left,
    "]": mountain_right,
    "^": mountain_top,
    "o": mountain_dots,
}



level = [
    "                         ?                                                                   ===========   ===?             ?                                 ",
    "#                                                                                                                                                             ",
    "#                                                                                                                                          X      |      =    ",
    "#                   ?  #?#?#                          qw             qw                   ===                 =     ==   ?  ?  ?          XX      |     ===   ",
    "#    ^                                       qw       as   ^         as                                           ^                      XXX      |    =====  ",
    "#   [o]              ^              qw       as       as  [o]        as         ^                                [o]             ^      XXXX      |    == ==  ",
    "#  [o  ]      errrt [o]     ert     as       as  ert  as [o  ]       as  errt  [o]     ert                      [o  ]     errt  [o]    XXXXX      X    == ==  ",                                  
    "####################################################################################  #################   ####################################################"
]

tile_generator.generate_level(level, transparents, solids)
tile_generator.generate_sprites([mario_walk_1, mario_walk_2, mario_walk_3, mario_jump, mario_idle])